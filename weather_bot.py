import os, requests, random

WEBHOOK = os.getenv("WEBHOOK")
KEY     = os.getenv("WEATHER_KEY")          # 和风天气专属 Key
HOST = "mr2vhe92ku.re.qweatherapi.com"       # 和风天气专属 Host（如 mr2vhe92ku.re.qweatherapi.com）
CITY    = "101190406"                       # 苏州市 LocationID

# ---------- 和风天气 ----------
url = f"https://{HOST}/v7/weather/3d?location={CITY}&key={KEY}"
w = requests.get(url, timeout=10).json()

if w.get("code") != "200":
    raise RuntimeError(f"和风天气错误：{w}")

today = w["daily"][0]
weather = (
    f"【机器人】苏州市今日天气\n"
    f"白天：{today['textDay']} {today['tempMax']}°C\n"
    f"夜间：{today['textNight']} {today['tempMin']}°C"
)

requests.post(WEBHOOK, json={"msg_type": "text", "content": {"text": weather}})

# ---------- 2. 名人名言 ----------
quotes = [
    "生活不可能像你想象的那么好，但也不会像你想象的那么糟。——莫泊桑",
    "一个人可以被毁灭，但绝不能被打败。——海明威",
    "不管怎么样，明天又是新的一天。——《飘》",
    "人类的一切智慧是包含在这四个字里面的：等待和希望。——《基督山伯爵》",
    "当你为错过太阳而哭泣的时候，你也要再错过群星了。——泰戈尔",
    "只有经历过地狱般的磨砺，才能练就创造天堂的力量。——泰戈尔",
    "星星发亮，是为了让每一个人有一天都能找到属于自己的星星。——《小王子》",
    "勇敢是，当你还未开始就已知道自己会输，可你依然要去做。——《杀死一只知更鸟》",
    "冬天来了，春天还会远吗？——雪莱",
    "不管前方的路有多苦，只要走的方向正确，都比站在原地更接近幸福。——宫崎骏",
     "强势文化造就强者，弱势文化造就弱者。——豆豆《遥远的救世主》",
    "神即道，道法自然，如来。——豆豆《遥远的救世主》",
    "生存法则很简单，就是忍人所不忍，能人所不能。——豆豆《遥远的救世主》",
    "这世上原本就没什么神话，所谓的神话不过是常人的思维所不易理解的平常事。——豆豆《遥远的救世主》",
    "如果我的能力只能让我穷困潦倒，那穷困潦倒就是我的价值。——豆豆《遥远的救世主》",
    "如果冬天来了，春天还会远吗？——雪莱《雪莱诗选》",
    "我明白了，我已经找到了存在的答案，我恶心的答案，我整个生命的答案。——萨特《恶心》",
    "世界上有这样一些幸福的人，他们把自己的痛苦化作他人的幸福。——斯托夫人《汤姆叔叔的小屋》",
    "当格里高·萨姆莎从烦躁不安的梦中醒来时，发现他在床上变成了一个巨大的跳蚤。——卡夫卡《变形记》",
    "当现实折过来严丝合缝地贴在我们长期的梦想上时，它盖住了梦想。——普鲁斯特《追忆似水年华》",
    "人与人之间，最可痛心的事莫过于在你认为理应获得善意的地方，却遭受了烦扰。——拉伯雷《巨人传》",
    "在别人心中存在的人，就是这个人的灵魂。——帕斯捷尔纳克《日瓦戈医生》",
    "美德犹如名香，经燃烧或压榨而其香愈烈。——培根《培根论说文集》",
    "亲爱的艾妮斯，我出国，为了爱你，我留在国外，为了爱你，我回国，也是为了爱你!——狄更斯《大卫·科波菲尔》",
    "强迫经常使热恋的人更加铁心，而从来不能叫他们回心转意。——席勒《阴谋与爱情》",
    "在各种事物的常理中，爱情是无法改变和阻挡的。——薄伽丘《十日谈》",
    "只要你是天鹅蛋，就是生在养鸡场里也没有什么关系。——安徒生《安徒生童话》",
    "就投机钻营来说，世故的价值永远是无可比拟的。——果戈里《死魂灵》",
    "谁都可能出个错儿，你在一件事情上越琢磨得多就越容易出错。——哈谢克《好兵帅克历险记》",
    "我们经历着生活中突然降临的一切，毫无防备。——米兰·昆德拉《生命中不能承受之轻》",
    "他发现了人类行为的一大法则：让事情不易到手。——马克·吐温《汤姆·索亚历险记》",
    "对有信仰的人，死是永生之门。——弥尔顿《失乐园》",
    "有一个传说，说的是有那么一只鸟儿，它一生只唱一次……——麦卡洛《荆棘鸟》",
    "离开一辈子后，他又回到了自己出生的那片土地上。——乔伊斯《尤利西斯》",
    "同上帝保持联系是一码事，让上帝一天二十四小时都待在身边就是另一码事了。——海勒《第二十二条军规》",
    "在甜蜜的梦乡里，人人都是平等的。——阿斯图里亚斯《总统先生》",
    "开发人类智力的矿藏是少不了要由患难来促成的。——大仲马《基度山伯爵》",
    "离你越近的地方，路途越远。——泰戈尔《泰戈尔诗选》",
    "悲伤使人格外敏锐。——罗曼·罗兰《约翰·克里斯朵夫》",
    "我在女人跟前经常失败，就是由于我太爱她们了。——卢梭《忏悔录》",
    "她睁大一双绝望的眼睛，观看她生活的寂寞。——福楼拜《包法利夫人》",
    "我听见美洲在歌唱，我听见各种不同的颂歌。——惠特曼《草叶集》",
    "倘若你能使你的心时常赞叹日常生活的神妙，你的苦痛的神妙必不减少。——纪伯伦《先知》",
    "一个人把他整个的一生都押在‘女人的爱’那一张牌上头赌博……——屠格涅夫《父与子》",
    "凡是想依正路达到这深密境界的人应从幼年起，就倾心向往美的形体。——柏拉图《文艺对话录》",
    "友谊就是一切。——马里奥·普佐《教父》",
    "已经活了七十二岁，依然像是昨天的事。——杜拉斯《物质生活》",
    "我明天回塔拉再去想吧。毕竟，明天又是另外的一天呢。——玛格丽特·米切尔《飘》",
    "盲目可以增加你的勇气，因为你无法看到危险。——斯威夫特《格列佛游记》",
    "本人系疗养与护理院的居住者……——格拉斯《铁皮鼓》",
    "每当我追溯自己的青春年华时，那些日子就像是暴风雪之晨的白色雪花。——纳博科夫《洛莉塔》",
    "宽宏大量，是惟一能够照亮伟大灵魂的光芒。——雨果《巴黎圣母院》",
    "决心不过是记忆的奴隶，它会根据你的记忆随意更改。——莎士比亚《哈姆雷特》",
    "世间的很多事物追求时候的兴致总要比享用时候的兴致浓烈。——莎士比亚《威尼斯商人》",
    "你越是没心肝，就越高升得快。——巴尔扎克《高老头》",
    "我只想证明一件事，就是，那时魔鬼引诱我……——陀思妥耶夫斯基《罪与罚》",
    "你瞧，桑丘·潘沙朋友，那边出现了三十多个大得出奇的巨人。——塞万提斯《堂·吉诃德》",
    "我并不愿意你受的苦比我受的还大……——勃朗特《呼啸山庄》",
    "幸福的家庭是相同的，不幸的家庭各有各的不同。——托尔斯泰《安娜·卡列尼娜》",
    "人都是为希望而活，因为有了希望，人才有生活的勇气。——托尔斯泰《战争与和平》",
    "一个人只要能忘我和爱别人，他在心理上就不会失衡。——托尔斯泰《战争与和平》",
    "每个人都会有缺陷，就像被上帝咬过的苹果。——托尔斯泰《战争与和平》",
    "没人对你说‘不’的时候，你是长不大的。——托尔斯泰《战争与和平》",
    "从现在起，我开始谨慎地选择我的生活。——米兰·昆德拉《生命中不能承受之轻》",
    "令她反感的，远不是世界的丑陋，而是这个世界所戴的漂亮面具。——米兰·昆德拉《生命中不能承受之轻》",
    "为你，千千万万遍。——胡赛尼《追风筝的人》[^53^]",
    "被真相伤害总比被谎言欺骗得好。——胡赛尼《追风筝的人》",
    "记住该记住的，忘记该忘记的。——塞林格《麦田里的守望者》",
    "一个不成熟人的标志是他愿意为某个原则轰轰烈烈地死去。——塞林格《麦田里的守望者》",
    "人的心只容得下一定程度的绝望。——雨果《巴黎圣母院》",
    "万物中的一切并非都是合乎人情的美。——雨果《巴黎圣母院》",
    "我越是孤独，越是没有朋友，越是没有支持，我就得越尊重我自己。——勃朗特《简·爱》",
    "生命太短暂了，没时间恨一个人那么久。——勃朗特《简·爱》",
    "一个人需要的东西愈少，他的幸福就愈大。——高尔基《我的大学》",
    "我的梦想，值得我本人去争取。——司汤达《红与黑》",
    "礼貌，就是不让坏脾气发出来。——司汤达《红与黑》",
    "不要向井里吐痰，也许你还会来喝井里的水。——肖洛霍夫《静静的顿河》",
    "一个人只要有意志力，就能超越他的环境。——杰克·伦敦《马丁·伊登》",
    "站在痛苦之外规劝受苦的人，是件很容易的事。——埃斯库罗斯《被缚的普罗米修斯》",
    "感情有理智根本无法理解的理由。——毛姆《月亮与六便士》",
    "世界上一切好东西对于我们，除了加以使用外，实在没有别的好处。——笛福《鲁滨逊漂流记》",
    "每当我追溯自己的青春年华时，那些日子就像是暴风雪之晨的白色雪花。——纳博科夫《洛丽塔》",
    "幸福的家庭都是相似的，不幸的家庭各有各的不幸。——托尔斯泰《安娜·卡列尼娜》",
    "生存还是毁灭，这是个问题。——莎士比亚《哈姆雷特》",
    "人不是为失败而生的，一个人可以被毁灭，但不能被打败。——海明威《老人与海》",
    "我思故我在。——笛卡尔《第一哲学沉思》",
    "一切坚固的东西都烟消云散了。——马克思、恩格斯《共产党宣言》",
    "冬天从这里夺去的，春天会交还给你。——海涅《诗歌集》",
    "黑夜给了我黑色的眼睛，我却用它寻找光明。——顾城《一代人》",
    "面朝大海，春暖花开。——海子《面朝大海，春暖花开》",
    "真正的勇士敢于直面惨淡的人生。——鲁迅《记念刘和珍君》",
    "愿中国青年都摆脱冷气，只是向上走。——鲁迅《热风》",
    "无穷的远方，无数的人们，都和我有关。——鲁迅《这也是生活》",
    "人间不值得。——李诞《冷场》",
    "世界那么大，我想去看看。——顾少强辞职信",
    "生活不止眼前的苟且，还有诗和远方。——高晓松",
    "愿你出走半生，归来仍是少年。——佚名网络语",
    "你若盛开，清风自来。——三毛",
    "你来人间一趟，你要看看太阳。——海子",
    "凡是过往，皆为序章；所有将来，皆可期待。——莎士比亚《暴风雨》",
    "愿你眼中总有光芒，活成你想要的模样。——卢思浩",
    "山有木兮木有枝，心悦君兮君不知。——《越人歌》",
    "玲珑骰子安红豆，入骨相思知不知。——温庭筠《杨柳枝》",
    "桃李春风一杯酒，江湖夜雨十年灯。——黄庭坚《寄黄几复》",
    "人生若只如初见，何事秋风悲画扇。——纳兰性德《木兰花令》",
    "衣带渐宽终不悔，为伊消得人憔悴。——柳永《蝶恋花》",
    "十年生死两茫茫，不思量，自难忘。——苏轼《江城子》",
    "曾经沧海难为水，除却巫山不是云。——元稹《离思》",
    "山有峰顶，海有彼岸；漫漫长途，终有回转。——余光中",
    "万物皆有裂痕，那是光照进来的地方。——莱昂纳德·科恩",
    "你若安好，便是晴天。——林徽因传",
    "世界上只有一种真正的英雄主义，那就是在认清生活的真相后依然热爱生活。——罗曼·罗兰《米开朗琪罗传》",
    "不要温和地走进那个良夜。——狄兰·托马斯",
    "你站在桥上看风景，看风景的人在楼上看你。——卞之琳《断章》",
    "岁月不饶人，我亦未曾饶过岁月。——木心",
    "人生天地间，忽如远行客。——《古诗十九首》",
    "长风破浪会有时，直挂云帆济沧海。——李白",
    "会当凌绝顶，一览众山小。——杜甫",
    "路漫漫其修远兮，吾将上下而求索。——屈原",
    "问君能有几多愁，恰似一江春水向东流。——李煜",
    "无可奈何花落去，似曾相识燕归来。——晏殊",
    "众里寻他千百度，蓦然回首，那人却在灯火阑珊处。——辛弃疾",
    "人生得意须尽欢，莫使金樽空对月。——李白",
    "天生我材必有用，千金散尽还复来。——李白",
    "小舟从此逝，江海寄余生。——苏轼",
    "此去经年，应是良辰好景虚设。——柳永",
    "流光容易把人抛，红了樱桃，绿了芭蕉。——蒋捷"
]
quote = random.choice(quotes)
requests.post(WEBHOOK, json={"msg_type": "text", "content": {"text": f"—— {quote}"}})

# ---------- 3. 三大热榜 ----------
# ---------- 实时热榜 ----------
def fetch_hot():
    """聚合官方热榜"""
    sources = {
        "📈 微博热搜": "https://weibo.com/ajax/side/hotSearch",
        "📈 百度热榜": "https://top.baidu.com/api/board?platform=wise&tab=realtime",
        "📈 抖音热榜": "https://www.iesdouyin.com/web/api/v2/hotsearch/billboard/word/"
    }
    headers = {"User-Agent": "Mozilla/5.0"}

    for title, url in sources.items():
        try:
            if "weibo" in url:
                data = requests.get(url, headers=headers, timeout=10).json()
                items = [i["word"] for i in data["data"]["realtime"][:8]]
            elif "baidu" in url:
                data = requests.get(url, headers=headers, timeout=10).json()
                items = [i["word"] for i in data["data"]["cards"][0]["content"][:8]]
            elif "douyin" in url:
                data = requests.get(url, headers=headers, timeout=10).json()
                items = [i["word"] for i in data["word_list"][:8]]
        except Exception:
            items = ["接口异常，稍后重试"]

        card = {
            "msg_type": "post",
            "content": {
                "post": {
                    "zh_cn": {
                        "title": title,
                        "content": [[{"tag": "text", "text": f"{i+1}. {t}"}]
                                    for i, t in enumerate(items)]
                    }
                }
            }
        }
        requests.post(WEBHOOK, json=card)

fetch_hot()
